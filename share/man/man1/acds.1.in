.\" acds - ascii-chat discovery service
.\" Manual page for acds(1)
.\"
.TH ACDS 1 "December 2025" "acds @PROJECT_VERSION@" "User Commands"
.SH NAME
acds \- ASCII-Chat Discovery Service
.SH SYNOPSIS
.B acds
.RI [ address1 ]
.RI [ address2 ]
.RI [ options ]
.SH DESCRIPTION
.B acds
is a lightweight discovery service for ascii-chat that enables users to establish
sessions using memorable three-word phrases instead of IP addresses. Instead of
sharing "73.42.18.201:9999", users exchange phrases like "swift-river-canyon".
.PP
The service provides four core functions:
.TP
.B Session Registry
Tracks active conversations and allocates three-word identifiers
.TP
.B WebRTC Signaling
Manages peer connection negotiation and ICE candidate exchange
.TP
.B String Reservation
Allows users to reserve memorable phrases for 30 days
.TP
.B Identity Verification
Validates cryptographic credentials using Ed25519 signatures
.PP
After initial discovery through ACDS, participants establish direct peer-to-peer
connections via WebRTC DataChannels. The system uses SQLite for persistent storage
and integrates with coturn (STUN/TURN server) for NAT traversal.
.SH BIND ADDRESSES
ACDS supports dual-stack binding with flexible address configuration:
.TP
.B 0 arguments
Bind to localhost only (127.0.0.1 and ::1) - \fBsecure default\fR
.TP
.B 1 argument
Bind only to this IPv4 OR IPv6 address
.TP
.B 2 arguments
Bind to both addresses (must be one IPv4 AND one IPv6, order-independent)
.PP
.B Examples:
.RS
.nf
acds                          # Localhost only (127.0.0.1 + ::1) - secure default
acds 0.0.0.0 ::               # All interfaces (dual-stack) - INSECURE, publicly accessible
acds 0.0.0.0                  # All IPv4 interfaces
acds ::                       # All IPv6 interfaces
acds 192.168.1.100 ::1        # Specific IPv4 + localhost IPv6
acds --port 9443              # Use port 9443
.fi
.RE
.PP
.B Security Note:
By default, ACDS only accepts connections from localhost. To make the service
publicly accessible on a network, you must explicitly specify bind addresses
such as \fB0.0.0.0\fR and \fB::\fR. This prevents accidental exposure of the
discovery service to untrusted networks.
.SH OPTIONS
.TP
.BR \-h ", " \-\-help
Print usage information and exit.
.TP
.BR \-v ", " \-\-version
Print version information and exit.
.TP
.BR \-p ", " \-\-port =\fIPORT\fR
TCP port to listen on. Default is 27225 (one higher than ascii-chat server's 27224).
.TP
.BR \-d ", " \-\-db =\fIPATH\fR
SQLite database path for storing session registry, string reservations, and identity data.
.RS
.IP \(bu 2
\fBUnix default\fR: ~/.config/ascii-chat/acds.db
.IP \(bu 2
\fBWindows default\fR: %APPDATA%\\ascii-chat\\acds.db
.RE
.TP
.BR \-K ", " \-\-key =\fIKEY\fR
SSH/GPG key file for server authentication. Supports multiple formats:
.RS
.IP \(bu 2
/path/to/key - Local file path
.IP \(bu 2
gpg:keyid - GPG key identifier
.IP \(bu 2
github:user - Fetch from GitHub
.IP \(bu 2
gitlab:user - Fetch from GitLab
.IP \(bu 2
ssh - Use SSH agent
.RE
.IP
Implies --encrypt. Default: [unset]
.TP
.BR \-L ", " \-\-log\-file =\fIPATH\fR
Write log output to the specified file. Default is stderr.
.TP
.BR \-l ", " \-\-log\-level =\fILEVEL\fR
Set logging verbosity level: dev, debug, info, warn, error, fatal.
.RS
.IP \(bu 2
\fBDefault\fR: info
.IP \(bu 2
\fBPrecedence\fR: LOG_LEVEL environment variable > \-\-log\-level > default
.RE
.SH SESSION STRINGS
.B Format
.RS
Three lowercase words with hyphens: adjective-noun-noun
.RE
.PP
.B Generation Space
.RS
~500 adjectives × ~500 nouns × ~499 nouns ≈ 125 million unique combinations
.RE
.PP
.B Constraints
.RS
.IP \(bu 2
Second noun must differ from the first
.IP \(bu 2
Cryptographically random selection via libsodium
.IP \(bu 2
Collision detection against active sessions
.IP \(bu 2
Reserved protocol keywords are prohibited (help, admin, root, system, server, client, test, debug)
.RE
.PP
.B Lifespan
.RS
.IP \(bu 2
Ephemeral sessions expire after 24 hours
.IP \(bu 2
Reserved strings persist for 30 days with renewal capability
.RE
.SH IDENTITY SYSTEM
ACDS uses Ed25519 cryptographic signatures through libsodium for identity verification.
.PP
.B Key Storage
.RS
Keys reside at ~/.config/ascii-chat/acds_identity (Unix) or %APPDATA%\\ascii-chat\\acds_identity (Windows).
.RE
.PP
.B Fingerprint Display
.RS
SSH-style "drunken bishop" randomart (17×9 character grid) provides human-verifiable
identity comparison without reading hexadecimal strings.
.RE
.PP
.B Import Capability
.RS
Users can convert existing SSH Ed25519 keys into ASCII-Chat format via command-line option.
.RE
.SH PROTOCOL
ACDS uses the native ACIP (ASCII-Chat IP Protocol) over TCP with libsodium encryption.
No HTTP, WebSocket, or JSON infrastructure required.
.PP
.B Message Types
.RS
.IP \(bu 2
0x01-0x1F: Existing ACIP functions (media streams)
.IP \(bu 2
0x20-0x2F: Session management operations
.IP \(bu 2
0x30-0x3F: WebRTC signaling
.IP \(bu 2
0x40-0x4F: String reservation
.IP \(bu 2
0xFE: Keepalive
.IP \(bu 2
0xFF: Error responses
.RE
.SH MDNS
You don't necessarily need an internet connection to an ACDS server to discover 
and talk to other ascii-chatters.
.TP
.B mDNS Discovery
Clients broadcast via _acip._tcp service type on local networks, advertising
identity fingerprints in TXT records.
.TP
.B Manual Verification
Clients and servers can pre-share public keys; they both have a flag to verify 
the other's identity when accepting connections.
.PP
Both modes display prominent warnings about unverified identities and require
explicit user confirmation.
.SH SECURITY
.IP \(bu 2
Session strings cannot be enumerated (random generation prevents brute-force discovery)
.IP \(bu 2
No session listing endpoint exists
.IP \(bu 2
Identity-based banning restricts abusive public keys
.IP \(bu 2
IP-level bans address severe violations
.IP \(bu 2
Comprehensive audit logging captures all operations
.SH FILES
.TP
.I ~/.config/ascii-chat/acds.db
Default SQLite database (Unix)
.TP
.I %APPDATA%\\\\ascii-chat\\\\acds.db
Default SQLite database (Windows)
.TP
.I ~/.config/ascii-chat/acds_identity
Default Ed25519 identity key (Unix)
.TP
.I %APPDATA%\\\\ascii-chat\\\\acds_identity
Default Ed25519 identity key (Windows)
.SH ENVIRONMENT
.TP
.B LOG_LEVEL
Override default log level (dev, debug, info, warn, error, fatal)
.SH EXAMPLES
.PP
Start ACDS on all interfaces with default port:
.RS
.nf
acds
.fi
.RE
.PP
Start ACDS on specific interface with custom database:
.RS
.nf
acds 192.168.1.100 --db /var/lib/acds/sessions.db
.fi
.RE
.PP
Start ACDS with authentication and custom port:
.RS
.nf
acds --port 9443 --key gpg:F1A2B3C4D5E6F7G8
.fi
.RE
.PP
Start ACDS with debug logging:
.RS
.nf
acds --log-level debug --log-file /var/log/acds.log
.fi
.RE
.SH SEE ALSO
.BR ascii-chat (1),
.BR coturn (1)
.PP
Full documentation: <https://github.com/zfogg/ascii-chat>
.PP
Issue #239 - ACDS Specification: <https://github.com/zfogg/ascii-chat/issues/239>
.SH AUTHOR
Written by Zack Fogg and contributors.
.SH COPYRIGHT
Copyright \(co 2024-2025 Zack Fogg.
License: MIT <https://opensource.org/licenses/MIT>
