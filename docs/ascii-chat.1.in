.\" ascii-chat - terminal video chat with ASCII art
.\" Manual page for ascii-chat(1)
.\"
.TH ASCII-CHAT 1 "December 2025" "ascii-chat @PROJECT_VERSION@" "User Commands"
.SH NAME
ascii-chat \- Video chat in your terminal
.SH SYNOPSIS
.B ascii-chat
.RI [ options ]
.PP
.B ascii-chat
.I mode
.RI [ options ]
.PP
.B ascii-chat server
.RI [ options ]
.PP
.B ascii-chat client
.RI [ options ]
.SH DESCRIPTION
.B ascii-chat
is a terminal-based video chat application that converts webcam video to ASCII
art in real-time. It enables video chat directly in your terminal, whether you're
using a local console, a remote SSH session, or any terminal emulator.
.PP
The program operates in two modes:
.TP
.B server
Runs a video chat server that accepts connections from multiple clients,
mixes their audio and video streams together, and broadcasts the mixed streams
out to all connected clients. Clients see a grid of ascii video cells displaying
the users of the call.
.TP
.B client
Connects to an ascii-chat server, captures video from the local webcam, sends it
to the server, and displays the combined video feed grid from all participants that
the server sends back.
.SH OPTIONS
.SS "Basic Options"
.TP
.BR \-h ", " \-\-help
Print usage information and exit.
.TP
.BR \-v ", " \-\-version
Print version information and exit.
.TP
.BR \-q ", " \-\-quiet
Suppress console logging output. Only errors and critical warnings are displayed.
.TP
.BR \-V ", " \-\-verbose
Increase output verbosity. Can be specified multiple times for increased detail:
.RS
.IP \(bu 2
\fB\-V\fR: More detailed output
.IP \(bu 2
\fB\-VV\fR: Even more detail
.IP \(bu 2
\fB\-VVV\fR: Maximum verbosity
.RE
.TP
.BR \-L ", " \-\-log\-file =\fIPATH\fR
Write log output to the specified file. The default log files are client.log and
server.log in your current working directory.
.SS "Network Options
.TP
.BR \-a ", " \-\-address =\fIADDR\fR
Server address to connect to (client) or IPv4 bind address (server).
Default: \fBlocalhost\fR (client), \fB127.0.0.1\fR (server)
.TP
.BR \-p ", " \-\-port =\fIPORT\fR
Server port number. Valid range: 1-65535.
Default: \fB27224\fR ("ASCII" on a phone dial pad)
.SS "Network Options (Server Only)"
.TP
.BR \-\-address6 =\fIADDR\fR
IPv6 bind address. Use "::" to bind to all IPv6 interfaces.
Can be used with \fB\-\-address\fR for dual-stack support.
Default: \fB::1\fR
.SS "Network Options (Client Only)"
.TP
.BR \-H ", " \-\-host =\fIHOSTNAME\fR
Hostname for DNS lookup (alternative to \-\-address).
.SS "Terminal Dimensions (Client Only)"
.TP
.BR \-x ", " \-\-width =\fICOLS\fR
Set terminal width in characters. Disables auto-detection for width.
Default: auto-detect from terminal size, fallback to \fB110\fR
.TP
.BR \-y ", " \-\-height =\fIROWS\fR
Set terminal height in characters. Disables auto-detection for height.
Default: auto-detect from terminal size, fallback to \fB70\fR
.SS "Display Options (Client Only)"
.TP
.BR \-\-color\-mode =\fIMODE\fR
Terminal color mode: auto, mono, 16, 256, truecolor.
Default: \fBauto\fR (detect terminal capabilities)
.TP
.BR \-M ", " \-\-render\-mode =\fIMODE\fR
Rendering mode: foreground (text colored), background
(terminal background colored, text color default),
half-block (Unicode half-blocks for 2x vertical resolution).
Default: \fBforeground\fR
.TP
.BR \-\-utf8
Force enable UTF-8 support for Unicode palette characters.
Required for half-block render mode.
.TP
.BR \-s ", " \-\-stretch
Allow image stretching without preserving aspect ratio.
Default: preserve aspect ratio (may have letterboxing).
.TP
.BR \-P ", " \-\-palette =\fIPALETTE\fR
ASCII character palette: standard, blocks, digital, minimal, cool, custom.
Default: \fBstandard\fR
.TP
.BR \-C ", " \-\-palette\-chars =\fICHARS\fR
Custom palette characters (implies \-\-palette=custom).
Characters should be ordered from darkest to brightest.
Example: " .:-=+*#%@"
.TP
.BR \-\-show\-capabilities
Print detected terminal capabilities and exit.
.SS "Webcam Options (Client Only)"
.TP
.BR \-c ", " \-\-webcam\-index =\fIINDEX\fR
Webcam device index (0-based). Index 0 is the first available device.
Default: \fB0\fR
.TP
.BR \-f ", " \-\-webcam\-flip
Toggle horizontal flipping of webcam image.
Default: flipped (mirror mode)
.TP
.BR \-\-test\-pattern
Use a test pattern instead of real webcam input.
Useful for testing when you don't have a physical webcam connected to the computer.
.TP
.BR \-\-list\-webcams
List all available webcam devices and exit.
Shows device index and name for each detected camera.
.TP
.BR \-\-fps =\fIFPS\fR
Desired frame rate (1-144).
Default: \fB60\fR
.SS "Snapshot Mode (Client Only)"
.TP
.BR \-S ", " \-\-snapshot
Connect to a server and print at least one frame, then exit. 
Some webcams "warm up" and need time, so there is --snapshot\-delay to control how long after the camera starts before a frame is sampled.
In your terimanl you can pipe the stdout of \fIascii-chat client --snapshot\fR a file to take a photo.
--snapshot is useful for testing, scripting, ai agent like Claude and Cursor, and CI/CD pipelines. It's also very useful when combined with \-\-mirror.
.PP
Connection behavior in snapshot mode:
.RS
.IP \(bu 2
\fBNo retries\fR: If the connection fails, exits immediately with error code 1
instead of retrying. Ideal for scripting and CI/CD pipelines.
.IP \(bu 2
\fBNo reconnection\fR: If the connection is lost during capture, exits with an error
instead of attempting to reconnect.
.RE
.TP
.BR \-D ", " \-\-snapshot\-delay =\fISECONDS\fR
Delay in seconds before capturing snapshot (for frame warmup).
Default: \fB3.0\fR
.SS "Mirror Mode (Client Only)"
.TP
.BR \-\-mirror
View your webcam as ASCII art directly in the terminal without connecting
to a server. This is a local-only mode that captures from your webcam,
converts the video to ASCII art in real-time, and displays it in your terminal.
Useful for testing your webcam setup or just watching yourself in ASCII.
Press Ctrl-C to exit.
Very useful when combined with \-\-snapshot.
.PP
Note: Mirror mode is incompatible with audio (\fB\-\-audio\fR).
.SS "Audio Options (Client Only)"
.TP
.BR \-A ", " \-\-audio
Enable audio capture and streaming.
.TP
.BR \-\-audio\-device =\fIINDEX\fR
Audio input device index. Use \fB-1\fR for system default.
Default: \fB-1\fR
.TP
.BR \-\-list\-microphones
List all available audio input devices (microphones) and exit.
Shows device index, name, and capabilities.
.TP
.BR \-\-list\-speakers
List all available audio output devices (speakers) and exit.
Shows device index, name, and capabilities.
.SS "Encryption Options"
.TP
.BR \-E ", " \-\-encrypt
Enable packet encryption.
Default: \fBenabled\fR
.TP
.BR \-K ", " \-\-key =\fIKEY\fR
SSH key for authentication. Accepts:
.RS
.IP \(bu 2
File path: /path/to/key (SSH Ed25519 private key)
.IP \(bu 2
GitHub: github:username
.IP \(bu 2
GitLab: gitlab:username
.IP \(bu 2
Auto-detect: ssh (uses ~/.ssh/id_ed25519)
.RE
.IP
Implies \-\-encrypt.
.TP
.BR \-\-password [=\fIPASSWORD\fR]
Password for connection encryption. If PASSWORD is not provided,
prompts interactively. Both client and server must use the same password.
Implies \-\-encrypt.
.RS
.IP \(bu 2
\fBLength\fR: 8-256 characters (inclusive)
.IP \(bu 2
\fBCharacters\fR: Any UTF-8 characters are supported. Cannot contain null bytes.
.IP \(bu 2
\fBKey Derivation\fR: Uses Argon2id (memory-hard, ~64MB RAM, ~0.1s)
.RE
.TP
.BR \-F ", " \-\-keyfile =\fIFILE\fR
Read encryption key from FILE. Implies \-\-encrypt.
.TP
.BR \-\-no\-encrypt
Explicitly disable encryption, even if keys are available.
.TP
.BR \-\-server\-key =\fIKEY\fR
(Client only) Expected server public key for identity verification.
Prevents man-in-the-middle attacks. Can be a key string or path to .pub file.
.TP
.BR \-\-client\-keys =\fIFILE\fR
(Server only) File containing allowed client public keys for authentication.
Uses SSH \fIauthorized_keys\fR format: one key per line, each line formatted as
\fCssh-ed25519 AAAAC3... [comment]\fR. Also accepts \fIknown_hosts\fR format.
Only Ed25519 keys are parsed; RSA/ECDSA keys in the file are ignored.
.SS "Configuration"
.TP
.BR \-\-config =\fIPATH\fR
Load configuration from TOML file at PATH.
.TP
.BR \-\-config\-create [=\fIPATH\fR]
Create a default configuration file and exit.
If PATH is not specified, uses the default location.
.SH EXAMPLES
.SS "Start a basic server"
.nf
ascii-chat server
.fi
.SS "Connect to a local server"
.nf
ascii-chat client
.fi
.SS "Connect to a remote server with truecolor"
.nf
ascii-chat client \-\-address example.com \-\-color\-mode truecolor
.fi
.SS "Server with encryption using SSH key"
.nf
ascii-chat server \-\-key ~/.ssh/id_ed25519
.fi
.SS "Client with server verification"
.nf
ascii-chat client \-\-address example.com \-\-server\-key ~/.ssh/server.pub
.fi
.SS "Capture a single ASCII snapshot"
.nf
ascii-chat client \-\-snapshot \-\-color\-mode truecolor
.fi
.SS "View webcam locally in mirror mode"
.nf
ascii-chat client \-\-mirror \-\-color\-mode truecolor
.fi
.SS "Capture local webcam snapshot (no server)"
.nf
ascii-chat client \-\-mirror \-\-snapshot \-\-snapshot\-delay 1.0
.fi
.SS "Test without webcam using test pattern"
.nf
ascii-chat client \-\-test\-pattern \-\-color\-mode truecolor
.fi
.SS "Use half-block rendering for higher resolution"
.nf
ascii-chat client \-\-render\-mode half\-block \-\-utf8
.fi
.SS "Use GitHub key for authentication"
.nf
ascii-chat client \-\-key github:username \-\-address example.com
.fi
.SS "Use Unicode block characters for higher contrast"
.nf
ascii-chat client \-\-palette blocks \-\-utf8
.fi
.SH PALETTES
Built-in ASCII character palettes for different visual styles.
Characters are ordered from darkest (leftmost) to brightest (rightmost).
.TP
.B standard
Default palette using ASCII characters only (no UTF-8 required).
.br
Characters: \fC   ...',;:clodxkO0KXNWM\fR
.TP
.B blocks
Unicode block shading characters for smooth gradients (requires UTF-8).
.br
Characters: \fC   \[u2591]\[u2591]\[u2592]\[u2592]\[u2593]\[u2593]\[u2588]\[u2588]\fR
.TP
.B digital
Digital/tech aesthetic with Unicode characters (requires UTF-8).
.br
Characters: \fC   -=\[u2261]\[u2263]\[u25B0]\[u25B1]\[u25FC]\fR
.TP
.B minimal
Minimal palette with basic ASCII characters only.
.br
Characters: \fC   .-+*#\fR
.TP
.B cool
Vertical bar progression for unique visual effect (requires UTF-8).
.br
Characters: \fC   \[u2581]\[u2582]\[u2583]\[u2584]\[u2585]\[u2586]\[u2587]\[u2588]\fR
.TP
.B custom
User-defined palette via \fB\-\-palette\-chars\fR option.
.PP
Use \fB\-\-utf8\fR to force UTF-8 support when using Unicode palettes.
.SH RENDER MODES
Three rendering modes control how colors are applied:
.TP
.B foreground
Default mode. ASCII characters are colored but displayed on the terminal's
default background. Best compatibility across terminals.
.TP
.B background
Terminal background cells are colored. Characters appear in the default
foreground color. Creates a blocky, pixel-art appearance.
.TP
.B half\-block
Uses Unicode half-block characters (\[u2580], \[u2584]) to achieve 2x vertical
resolution. Each character cell displays two pixels (top and bottom halves).
Requires UTF-8 support (\fB\-\-utf8\fR).
.SH CONFIGURATION
Configuration can be stored in a TOML file at the default location
(see FILES section) or specified via \fB\-\-config\fR.
.PP
.B Configuration Priority:
.RS
Command-line arguments override config file values.
Config file values override default values.
.RE
.PP
.B Configuration Sections:
.RS
.IP \(bu 2
\fB[network]\fR: port
.IP \(bu 2
\fB[server]\fR: bind_ipv4, bind_ipv6
.IP \(bu 2
\fB[client]\fR: address, width, height, webcam_index, webcam_flip, color_mode,
render_mode, fps, stretch, quiet, snapshot_mode, snapshot_delay, test_pattern,
show_capabilities, force_utf8
.IP \(bu 2
\fB[audio]\fR: enabled, device
.IP \(bu 2
\fB[palette]\fR: type, chars
.IP \(bu 2
\fB[crypto]\fR: encrypt_enabled, key, password, keyfile, no_encrypt,
server_key (client), client_keys (server)
.IP \(bu 2
\fB[logging]\fR: log_file
.RE
.PP
.B Security Warning:
While passwords can be stored in the config file, this is discouraged.
Use \fB\-\-password\fR interactively or environment variables instead.
Secure your config file permissions if it contains sensitive data.
.SH LIMITS
.TP
.B Maximum Clients
Up to 10 clients can connect to a single server simultaneously.
.TP
.B Video Grid Layout
Clients are arranged in an automatically-sized grid (e.g., 2x2, 3x3).
The grid size adjusts based on the number of connected clients.
.TP
.B Frame Rate
Default 60 FPS. Configurable from 1-144 FPS.
.SH ENVIRONMENT
.TP
.B SSH_AUTH_SOCK
Path to SSH agent socket for password-free key authentication (Unix only).
.TP
.B ASCII_CHAT_SSH_PASSWORD
Passphrase for encrypted SSH keys. Prefer using ssh-agent when possible.
.TP
.B LOG_LEVEL
Set logging verbosity: 0=DEV, 1=DEBUG, 2=INFO, 3=WARN, 4=ERROR, 5=FATAL.
.TP
.B TERM
Terminal type, used for auto-detecting color capabilities.
.TP
.B COLORTERM
Color terminal indicator. Set to "truecolor" or "24bit" for truecolor support.
.TP
.B WEBCAM_DISABLED
Automatically enables test pattern mode when set to "1", "true", "yes", or "on".
Useful for CI/CD pipelines and testing environments without a physical webcam.
Equivalent to passing \fB\-\-test\-pattern\fR.
.SH FILES
.TP
.I ~/.ssh/id_ed25519
Default SSH Ed25519 private key used for encryption if \fB\-\-key\fR is not specified.
.TP
.I ~/.ssh/id_ed25519.pub
Public key corresponding to the default private key.
.TP
.I $XDG_CONFIG_HOME/ascii-chat/ \fRor\fI ~/.ascii-chat/
Configuration directory on Linux/macOS.
Uses $XDG_CONFIG_HOME/ascii-chat/ if XDG_CONFIG_HOME is set, otherwise ~/.ascii-chat/.
Contains config.toml and known_hosts.
.TP
.I %APPDATA%\eascii-chat\e \fRor\fI ~\e.ascii-chat\e
Configuration directory on Windows.
Uses %APPDATA%\eascii-chat\e if APPDATA is set, otherwise ~\e.ascii-chat\e.
Contains config.toml and known_hosts.
.TP
.I /etc/ascii-chat/config.toml
System-wide configuration file on Linux/macOS.
Used for server deployments or shared configurations.
.TP
.I /usr/local/etc/ascii-chat/config.toml
Alternative system-wide configuration file (BSD-style path).
Used for locally-installed configurations.
.TP
.I config.toml
Configuration file in the configuration directory.
.TP
.I known_hosts
Known hosts file for TOFU (Trust On First Use) server verification.
.SH EXIT STATUS
Exit codes correspond to the \fBasciichat_error_t\fR enum values:
.TP
.B 0
Success (ASCIICHAT_OK).
.TP
.B 1
General unspecified error (ERROR_GENERAL).
.TP
.B 2
Invalid command-line arguments or options (ERROR_USAGE).
.TP
.B 3
Memory allocation failed (ERROR_MEMORY).
.TP
.B 4
Configuration file or settings error (ERROR_CONFIG).
.TP
.B 5\-7
Initialization errors (crypto, logging, platform).
.TP
.B 20\-25
Device errors (webcam, audio, terminal).
.TP
.B 40\-45
Network errors (bind, connect, timeout, protocol).
.TP
.B 60\-64
Cryptographic errors (key, auth, handshake, verification).
.TP
.B 80\-90
Runtime errors (thread, buffer, display, invalid state/param).
.TP
.B 100\-104
Signal and compression errors.
.SH SECURITY
.B ascii-chat
supports end-to-end encryption using modern cryptographic algorithms:
.IP \(bu 2
X25519 elliptic curve Diffie-Hellman key exchange
.IP \(bu 2
XSalsa20-Poly1305 authenticated encryption (AEAD)
.IP \(bu 2
Ed25519 digital signatures for SSH key authentication
.PP
Encryption is enabled by default. Use \fB\-\-no\-encrypt\fR to disable it.
Use \fB\-\-server\-key\fR on the client to verify server identity and prevent
man-in-the-middle attacks. Use \fB\-\-client\-keys\fR on the server to restrict
access to specific clients.
.SS "Trust On First Use (TOFU)"
When connecting to a server without \fB\-\-server\-key\fR, ascii-chat uses
TOFU verification similar to SSH. On first connection, the server's identity
key fingerprint is displayed and stored in \fIknown_hosts\fR. Subsequent
connections verify the server key matches the stored fingerprint.
.PP
If a server's key changes (possible MITM attack), the connection is rejected
with a warning. To connect anyway, remove the server entry from
\fIknown_hosts\fR and reconnect.
.SH NOTES
.IP \(bu 2
\fBEd25519 Keys Only\fR: Only Ed25519 SSH keys are supported. RSA and ECDSA keys
are NOT supported due to libsodium limitations. Generate Ed25519 keys with:
\fCssh-keygen -t ed25519\fR
.IP \(bu 2
\fBTerminal Detection\fR: Color capabilities are auto-detected from $COLORTERM,
$TERM, and terminal queries. Use \fB\-\-show\-capabilities\fR to see what was detected.
If detection fails, terminal size falls back to 110x70 characters.
.IP \(bu 2
\fBWebcam Warmup\fR: Many webcams need 1-3 seconds to adjust exposure and focus.
The \fB\-\-snapshot\-delay\fR option (default 3.0s) allows time for this.
.IP \(bu 2
\fBSSH Agent\fR: For password-free authentication with encrypted SSH keys,
use ssh-agent. Set $SSH_AUTH_SOCK to the agent socket path. Keys stay in the agent
and never touch disk in plaintext. Tip: put \fBeval $(ssh-agent) > /dev/null\fR in 
your shell profile and use \fCssh-add -s\fR to add keys to the agent.
.IP \(bu 2
\fBGitHub/GitLab Keys\fR: Use \fBgithub:username\fR or \fBgitlab:username\fR
to fetch public keys directly. All Ed25519 keys from the user's profile are
used, so users with multiple SSH keys (e.g., for different machines) can
authenticate with any of them. RSA and ECDSA keys are ignored.
.IP \(bu 2
\fBRemote Sessions\fR: When using ascii-chat over SSH or in tmux/screen,
truecolor may not work if $COLORTERM isn't forwarded. Try
\fB\-\-color\-mode truecolor\fR to force it, or add \fCset -g default-terminal "xterm-256color"\fR
to your tmux.conf.
.IP \(bu 2
\fBUTF-8 Palettes\fR: The "blocks", "digital", and "cool" palettes require UTF-8
terminal support. Use \fB\-\-utf8\fR to force UTF-8 mode if auto-detection fails.
.IP \(bu 2
\fBHalf-Block Mode\fR: The \fB\-\-render\-mode half\-block\fR option doubles vertical
resolution but requires UTF-8 support. Always use \fB\-\-utf8\fR with half-block mode.
.IP \(bu 2
\fBPerformance\fR: For best performance, use truecolor mode with a modern
terminal emulator (kitty, alacritty, iTerm2, Windows Terminal).
256-color mode requires color distance calculations which are slower.
.IP \(bu 2
\fBAspect Ratio\fR: By default, the video preserves aspect ratio with letterboxing.
Use \fB\-\-stretch\fR to fill the entire terminal (may distort the image).
.IP \(bu 2
\fBEncrypted SSH Keys\fR: Encrypted private keys work well with either ssh-agent or
the $ASCII_CHAT_SSH_PASSWORD environment variable. The passphrase prompt
only works in interactive terminals.
.SH BUGS
Report bugs at: https://github.com/zfogg/ascii-chat/issues
.SH AUTHOR
Zachary Fogg <me@zfo.gg>
.SH SEE ALSO
.BR ssh (1),
.BR ssh-keygen (1),
.BR ssh-agent (1)
.PP
.B ascii-chat
API documentation (section 3):
.BR ascii-chat-build (3),
.BR ascii-chat-config (3),
.BR ascii-chat-crypto (3),
.BR ascii-chat-client (3),
.BR ascii-chat-server (3),
.BR ascii-chat-errno (3),
.BR ascii-chat-options (3),
.BR ascii-chat-network (3),
.BR ascii-chat-platform (3)
.PP
Project homepage: https://github.com/zfogg/ascii-chat
.PP
Releases: https://github.com/zfogg/ascii-chat/releases
.PP
API documentation: https://zfogg.github.io/ascii-chat/
