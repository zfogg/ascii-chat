# =============================================================================
# Status Messages Module
# =============================================================================
# This module prints the final configuration status and build commands
#
# Prerequisites:
#   - All configuration complete
#   - Color variables set (from BuildConfiguration.cmake)
#   - Platform detection complete
#   - All dependencies found
#
# Outputs:
#   - Final status messages printed to console
# =============================================================================

# Status Messages (matching Makefile help output)
message(STATUS "")
message(STATUS "${BoldMagenta}ascii-chat Configuration:${ColorReset}")
message(STATUS "  Build type:        ${BoldYellow}${CMAKE_BUILD_TYPE}${ColorReset}")
message(STATUS "  C Standard:        ${BoldGreen}C${CMAKE_C_STANDARD}${ColorReset}")
message(STATUS "  C Compiler:        ${BoldCyan}${CMAKE_C_COMPILER}${ColorReset}")
message(STATUS "  C++ Standard:      ${BoldGreen}C++${CMAKE_CXX_STANDARD}${ColorReset}")
message(STATUS "  C++ Compiler:      ${BoldCyan}${CMAKE_CXX_COMPILER}${ColorReset}")
if(CMAKE_C_COMPILER_LAUNCHER)
    message(STATUS "  Compiler Launcher: ${BoldCyan}${CMAKE_C_COMPILER_LAUNCHER}${ColorReset}")
endif()
message(STATUS "  Compiler ID:       ${BoldCyan}${CMAKE_C_COMPILER_ID}${ColorReset} ${BoldGreen}${CMAKE_C_COMPILER_VERSION}${ColorReset}")
message(STATUS "  Archiver:          ${BoldCyan}${CMAKE_AR}${ColorReset}")
message(STATUS "  Ranlib:            ${BoldCyan}${CMAKE_RANLIB}${ColorReset}")
message(STATUS "  Platform:          ${BoldBlue}${CMAKE_SYSTEM_NAME}${ColorReset}")
message(STATUS "  Processor:         ${BoldYellow}${CMAKE_SYSTEM_PROCESSOR}${ColorReset}")
message(STATUS "  CPU Cores:         ${BoldGreen}${CPU_CORES}${ColorReset}")

# Determine build tool information
message(STATUS "  Build Tool:        ${BoldBlue}${CMAKE_GENERATOR}${ColorReset}")
if(CMAKE_GENERATOR STREQUAL "Ninja")
    message(STATUS "  Build Binary:      ${BoldBlue}ninja${ColorReset}")
elseif(CMAKE_GENERATOR MATCHES "Unix Makefiles")
    if(CMAKE_MAKE_PROGRAM)
        get_filename_component(MAKE_BINARY "${CMAKE_MAKE_PROGRAM}" NAME)
        message(STATUS "  Build Binary:      ${BoldBlue}${MAKE_BINARY}${ColorReset}")
    else()
        message(STATUS "  Build Binary:      ${BoldBlue}make${ColorReset}")
    endif()
elseif(CMAKE_GENERATOR MATCHES "Visual Studio")
    message(STATUS "  Build Binary:      ${BoldBlue}msbuild${ColorReset}")
elseif(CMAKE_GENERATOR MATCHES "Xcode")
    message(STATUS "  Build Binary:      ${BoldBlue}xcodebuild${ColorReset}")
else()
    message(STATUS "  Build Binary:      ${BoldBlue}${CMAKE_GENERATOR}${ColorReset}")
endif()
if(WIN32)
    if(WINDOWS_SDK_VERSION)
        message(STATUS "  Windows SDK:       ${BoldGreen}${WINDOWS_SDK_VERSION}${ColorReset}")
    endif()
    if(PLATFORM_WINDOWS_ARM64)
        message(STATUS "  Architecture:      ${BoldMagenta}ARM64${ColorReset}")
    elseif(PLATFORM_WINDOWS_ARM)
        message(STATUS "  Architecture:      ${BoldMagenta}ARM${ColorReset}")
    else()
        message(STATUS "  Architecture:      ${BoldMagenta}x64${ColorReset}")
    endif()
elseif(PLATFORM_DARWIN)
    message(STATUS "  Apple Silicon:     ${IS_APPLE_SILICON}")
    message(STATUS "  Rosetta:           ${IS_ROSETTA}")
endif()

# Display environment configuration if set
if(DEFINED ENV{CC} OR DEFINED ENV{CFLAGS} OR DEFINED ENV{CPPFLAGS} OR DEFINED ENV{LDFLAGS})
    message(STATUS "")
    message(STATUS "${BoldYellow}Environment Configuration:${ColorReset}")
    if(DEFINED ENV{CC})
        message(STATUS "  CC:                ${Cyan}$ENV{CC}${ColorReset}")
    endif()
    if(DEFINED ENV{CXX})
        message(STATUS "  CXX:               ${Cyan}$ENV{CXX}${ColorReset}")
    endif()
    if(DEFINED ENV{CFLAGS})
        message(STATUS "  CFLAGS:            ${Yellow}$ENV{CFLAGS}${ColorReset}")
    endif()
    if(DEFINED ENV{CPPFLAGS})
        message(STATUS "  CPPFLAGS:          ${Yellow}$ENV{CPPFLAGS}${ColorReset}")
    endif()
    if(DEFINED ENV{LDFLAGS})
        message(STATUS "  LDFLAGS:           ${Yellow}$ENV{LDFLAGS}${ColorReset}")
    endif()
endif()

message(STATUS "")
message(STATUS "${BoldYellow}Hardware Acceleration:${ColorReset}")
message(STATUS "  SIMD Mode:         ${BoldCyan}${ASCIICHAT_SIMD_MODE}${ColorReset}")
if(ENABLE_SIMD_SSE2)
    message(STATUS "  SSE2:              ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  SSE2:              ${BoldRed}Disabled${ColorReset}")
endif()
if(ENABLE_SIMD_SSSE3)
    message(STATUS "  SSSE3:             ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  SSSE3:             ${BoldRed}Disabled${ColorReset}")
endif()
if(ENABLE_SIMD_AVX2)
    message(STATUS "  AVX2:              ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  AVX2:              ${BoldRed}Disabled${ColorReset}")
endif()
if(ENABLE_SIMD_NEON)
    message(STATUS "  NEON:              ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  NEON:              ${BoldRed}Disabled${ColorReset}")
endif()
if(ENABLE_SIMD_SVE)
    message(STATUS "  SVE:               ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  SVE:               ${BoldRed}Disabled${ColorReset}")
endif()
if(ASCIICHAT_ENABLE_CRC32_HW)
    message(STATUS "  CRC32 HW:          ${BoldGreen}Enabled${ColorReset}")
else()
    message(STATUS "  CRC32 HW:          ${BoldRed}Disabled${ColorReset}")
endif()
message(STATUS "")
message(STATUS "${BoldYellow}Dependencies:${ColorReset}")
if(CRITERION_FOUND)
    message(STATUS "  Tests:             ${BoldGreen}Found${ColorReset}")
else()
    message(STATUS "  Tests:             ${BoldRed}Not Found${ColorReset}")
endif()
if(ZSTD_FOUND)
    message(STATUS "  zstd:              ${BoldGreen}Found${ColorReset}")
else()
    message(STATUS "  zstd:              ${BoldRed}Not Found${ColorReset}")
endif()
if(LIBSODIUM_FOUND)
    message(STATUS "  libsodium:         ${BoldGreen}Found${ColorReset}")
else()
    message(STATUS "  libsodium:         ${BoldRed}Not Found${ColorReset}")
endif()
if(BEARSSL_FOUND)
    message(STATUS "  BearSSL:           ${BoldGreen}Found${ColorReset}")
else()
    message(STATUS "  BearSSL:           ${BoldRed}Not Found${ColorReset}")
endif()
if(PORTAUDIO_FOUND)
    message(STATUS "  PortAudio:         ${BoldGreen}Found${ColorReset}")
else()
    message(STATUS "  PortAudio:         ${BoldRed}Not Found${ColorReset}")
endif()
# Show install hint if any required dependencies are missing
if(NOT ZSTD_FOUND OR NOT LIBSODIUM_FOUND OR NOT PORTAUDIO_FOUND)
    message(STATUS "")
    message(STATUS "  ${BoldYellow}Hint:${ColorReset} Run ${BoldCyan}${PROJECT_INSTALL_DEPS_SCRIPT}${ColorReset} to install missing dependencies")
endif()
message(STATUS "")
message(STATUS "${BoldYellow}Build Commands:${ColorReset}")
message(STATUS "  Configure Debug:     cmake -B build -DCMAKE_BUILD_TYPE=Debug     # With sanitizers (default)")
message(STATUS "  Configure Dev:       cmake -B build -DCMAKE_BUILD_TYPE=Dev       # Debug without sanitizers (faster)")
message(STATUS "  Configure Release:   cmake -B build -DCMAKE_BUILD_TYPE=Release")
message(STATUS "  Enable Coverage:     cmake -B build -DASCIICHAT_ENABLE_COVERAGE=ON  # Can combine with any build type")
message(STATUS "  Build:               cmake --build build")
message(STATUS "  Run:                 ./build/bin/ascii-chat [--help|--version] [client|server] [options...]")
if(CRITERION_FOUND)
    message(STATUS "  Build tests:         cmake --build build --target tests")
    message(STATUS "  Run tests:           ctest --test-dir build --output-on-failure --parallel 0")
endif()
message(STATUS "  Format code:         cmake --build build --target format")
message(STATUS "  Check formatting:    cmake --build build --target format-check")
message(STATUS "  Install deps:        ${PROJECT_INSTALL_DEPS_SCRIPT}")
message(STATUS "${BoldMagenta}========================================${ColorReset}")
message(STATUS "")

# Note: CMake will print "Configuring done" and "Generating done" messages
# with timing information after this script completes

