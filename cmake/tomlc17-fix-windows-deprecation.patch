diff --git a/src/tomlc17.c b/src/tomlc17.c
index 1358b5c..3a4b5f6 100644
--- a/src/tomlc17.c
+++ b/src/tomlc17.c
@@ -14,6 +14,43 @@
 #include <stdlib.h>
 #include <string.h>

+/* Platform-safe wrappers for deprecated Windows CRT functions */
+#ifdef _WIN32
+  /* Windows: Use secure CRT functions */
+  #ifndef _CRT_SECURE_NO_WARNINGS
+    /* fopen_s wrapper for consistent error handling */
+    static inline FILE *safe_fopen(const char *filename, const char *mode) {
+      FILE *fp = NULL;
+      errno_t err = fopen_s(&fp, filename, mode);
+      if (err != 0) {
+        return NULL;
+      }
+      return fp;
+    }
+
+    /* strerror_s wrapper with static buffer */
+    static inline const char *safe_strerror(int errnum) {
+      static __declspec(thread) char errbuf[256];
+      if (strerror_s(errbuf, sizeof(errbuf), errnum) == 0) {
+        return errbuf;
+      }
+      return "Unknown error";
+    }
+  #else
+    /* _CRT_SECURE_NO_WARNINGS is defined, use regular functions */
+    #define safe_fopen fopen
+    #define safe_strerror strerror
+  #endif
+#else
+  /* Unix: Use standard functions directly */
+  #define safe_fopen fopen
+  /* strerror is not thread-safe on some Unix platforms but widely used */
+  static inline const char *safe_strerror(int errnum) {
+    const char *msg = strerror(errnum);
+    return msg ? msg : "Unknown error";
+  }
+#endif
+
 const toml_datum_t DATUM_ZERO = {0};

 static toml_option_t toml_option = {0, realloc, free};
@@ -695,7 +732,7 @@ toml_result_t toml_parse(const char *s) {
  */
 toml_result_t toml_parse_file_ex(const char *fname) {
   toml_result_t result = {0};
-  FILE *fp = fopen(fname, "r");
+  FILE *fp = safe_fopen(fname, "r");
   if (!fp) {
     snprintf(result.errmsg, sizeof(result.errmsg), "fopen: %s", fname);
     return result;
@@ -745,7 +782,7 @@ toml_result_t toml_parse_file(FILE *fp) {
     errno = 0;
     top += fread(buf + top, 1, max - top, fp);
     if (ferror(fp)) {
-      snprintf(result.errmsg, sizeof(result.errmsg), "%s",
-               errno ? strerror(errno) : "Error reading file");
+      snprintf(result.errmsg, sizeof(result.errmsg), "%s",
+               errno ? safe_strerror(errno) : "Error reading file");
       FREE(buf);
       return result;
     }
