diff --git a/src/tomlc17.c b/src/tomlc17.c
--- a/src/tomlc17.c
+++ b/src/tomlc17.c
@@ -14,6 +14,36 @@
 #include <stdlib.h>
 #include <string.h>
 
+/* Platform-safe wrappers for deprecated Windows CRT functions */
+#ifdef _WIN32
+  /* Windows: Always use secure CRT functions to avoid deprecation warnings.
+   * This must be unconditional because in Unity builds, _CRT_SECURE_NO_WARNINGS
+   * may be defined by other headers before this file is compiled. */
+  static inline FILE *safe_fopen(const char *filename, const char *mode) {
+    FILE *fp = NULL;
+    errno_t err = fopen_s(&fp, filename, mode);
+    if (err != 0) {
+      return NULL;
+    }
+    return fp;
+  }
+  static inline const char *safe_strerror(int errnum) {
+    static __declspec(thread) char errbuf[256];
+    if (strerror_s(errbuf, sizeof(errbuf), errnum) == 0) {
+      return errbuf;
+    }
+    return "Unknown error";
+  }
+#else
+  /* Unix: Use standard functions directly */
+  #define safe_fopen fopen
+  /* strerror is not thread-safe on some Unix platforms but widely used */
+  static inline const char *safe_strerror(int errnum) {
+    const char *msg = strerror(errnum);
+    return msg ? msg : "Unknown error";
+  }
+#endif
+
 const toml_datum_t DATUM_ZERO = {0};
 
 static toml_option_t toml_option = {0, realloc, free};
@@ -682,7 +712,7 @@
  */
 toml_result_t toml_parse_file_ex(const char *fname) {
   toml_result_t result = {0};
-  FILE *fp = fopen(fname, "r");
+  FILE *fp = safe_fopen(fname, "r");
   if (!fp) {
     snprintf(result.errmsg, sizeof(result.errmsg), "fopen: %s", fname);
     return result;
@@ -732,8 +762,8 @@
     errno = 0;
     top += fread(buf + top, 1, max - top, fp);
     if (ferror(fp)) {
-      snprintf(result.errmsg, sizeof(result.errmsg), "%s",
-               errno ? strerror(errno) : "Error reading file");
+      (void)snprintf(result.errmsg, sizeof(result.errmsg), "%s",
+               errno ? safe_strerror(errno) : "Error reading file");
       FREE(buf);
       return result;
     }
